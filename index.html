<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kurnik</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .container {
            max-width: 960px;
        }
        .chicken-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        .chicken-card .image-wrapper {
            position: relative;
            width: 150px;
            height: 150px;
            margin-bottom: 1rem;
            overflow: hidden;
            border-radius: 0.5rem;
            border: 2px solid #d1d5db;
        }
        .chicken-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .chicken-card img:hover {
            transform: scale(1.05);
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            border-radius: 1rem;
        }
        .close-button {
            position: absolute;
            top: 20px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            transition: 0.3s;
        }
        .close-button:hover,
        .close-button:focus {
            color: #bbb;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center p-4 sm:p-8">

    <!-- Nagłówek -->
    <header class="w-full text-center py-8">
        <h1 class="text-4xl font-bold text-gray-800">Kurnik 🐔</h1>
        <p class="text-xl text-gray-600 mt-2">Lista kur</p>
    </header>

    <!-- Lista kur - zawartość będzie generowana dynamicznie przez JavaScript -->
    <main class="w-full container bg-white rounded-xl shadow-lg p-6 sm:p-8">
        <div id="chicken-list" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
            <!-- Tutaj zostaną wstawione karty kur i kogutów po załadowaniu strony -->
        </div>
    </main>

    <!-- Modal do powiększania zdjęć -->
    <div id="imageModal" class="modal">
        <span class="close-button" onclick="closeModal()">&times;</span>
        <img class="modal-content" id="modalImage">
    </div>

    <!-- Skrypty JavaScript -->
    <script>
        // Funkcja do otwierania modalu
        function openModal(imageElement) {
            const modal = document.getElementById('imageModal');
            const modalImage = document.getElementById('modalImage');
            
            modal.style.display = 'flex';
            modalImage.src = imageElement.src;
        }

        // Funkcja do zamykania modalu
        function closeModal() {
            const modal = document.getElementById('imageModal');
            modal.style.display = 'none';
        }

        // Zamykanie modalu po kliknięciu poza zdjęciem
        window.onclick = function(event) {
            const modal = document.getElementById('imageModal');
            if (event.target == modal) {
                closeModal();
            }
        }

        // Dane o kurach i kogutach - teraz przechowywane w JS
        const allChickens = [
            { name: "Kogut Lucjan", species: "Rosa Jarzębata", dob: "1 Lipiec 2024", ringNumber: "Nieznane", image: "https://placehold.co/150x150/e2e8f0/000000?text=Lucjan" },
            { name: "Kogut Henio", species: "Czarny typ włoszka Kogut", dob: "24 Czerwiec 2025", ringNumber: "Nieznane", image: "https://placehold.co/150x150/e2e8f0/000000?text=Henio" },
            { name: "Mariolcia", species: "Liliputki Polskie", dob: "Czerwiec/Lipiec 2025", ringNumber: "Nieznane", image: "https://placehold.co/150x150/e2e8f0/000000?text=Mariolcia" },
            { name: "Gabrysia", species: "Liliputki Polskie", dob: "Czerwiec/Lipiec 2025", ringNumber: "Nieznane", image: "https://placehold.co/150x150/e2e8f0/000000?text=Gabrysia" },
            { name: "Benio", species: "Liliputki Polskie", dob: "Czerwiec/Lipiec 2025", ringNumber: "Nieznane", image: "https://placehold.co/150x150/e2e8f0/000000?text=Benio" },
            { name: "Edzia", species: "Rosa Karmazyn z Zielonymi nóżkami", dob: "24 Czerwiec 2025", ringNumber: "Nieznane", image: "https://placehold.co/150x150/e2e8f0/000000?text=Edzia" },
            { name: "Albert", species: "Perliczki", dob: "Maj/Czerwiec 2025", ringNumber: "Nieznane", image: "https://placehold.co/150x150/e2e8f0/000000?text=Albert" },
            { name: "Miecia", species: "Perliczki", dob: "Maj/Czerwiec 2025", ringNumber: "Nieznane", image: "https://placehold.co/150x150/e2e8f0/000000?text=Miecia" },
            { name: "Melannia", species: "Perliczki", dob: "Maj/Czerwiec 2025", ringNumber: "Nieznane", image: "https://placehold.co/150x150/e2e8f0/000000?text=Melannia" },
            { name: "Halińcia", species: "Rosa Lawendowa", dob: "1 Lipiec 2024", ringNumber: "Nieznane", image: "https://placehold.co/150x150/e2e8f0/000000?text=Halincia" },
            { name: "Tereska", species: "Zielononóżka Kuropatwiana", dob: "1 Lipiec 2024", ringNumber: "Nieznane", image: "https://placehold.co/150x150/e2e8f0/000000?text=Tereska" },
            { name: "Danuta", species: "Rosa Bląd z zielonymi nóżkami", dob: "1 Lipiec 2024", ringNumber: "Nieznane", image: "https://placehold.co/150x150/e2e8f0/000000?text=Danuta" },
            { name: "Tekla", species: "Czerwona Rosa", dob: "Kwiecień 2023", ringNumber: "Nieznane", image: "https://placehold.co/150x150/e2e8f0/000000?text=Tekla" },
            { name: "Czesia", species: "Rosa Czerwona", dob: "ok. Marzec 2021", ringNumber: "Nieznane", image: "https://placehold.co/150x150/e2e8f0/000000?text=Czesia" },
            { name: "Fredzia", species: "Rosa Czerwona", dob: "Marzec 2020", ringNumber: "Nieznane", image: "https://placehold.co/150x150/e2e8f0/000000?text=Fredzia" },
            { name: "Jadzia", species: "Lenhorn", dob: "Nieznane (ok. 2016/2017)", ringNumber: "Nieznane", image: "https://placehold.co/150x150/e2e8f0/000000?text=Jadzia" },
            { name: "Celina", species: "Rosa Czerwona", dob: "Marzec 2020", ringNumber: "Nieznane", image: "https://placehold.co/150x150/e2e8f0/000000?text=Celina" },
        ];
        
        // Tablica do mapowania polskich nazw miesięcy na liczby
        const monthMap = {
            "Styczeń": 0, "Luty": 1, "Marzec": 2, "Kwiecień": 3, "Maj": 4, "Czerwiec": 5,
            "Lipiec": 6, "Sierpień": 7, "Wrzesień": 8, "Październik": 9, "Listopad": 10, "Grudzień": 11
        };

        /**
         * Parses a Polish date string into a Date object.
         * Handles formats like "1 Lipiec 2024", "Maj/Czerwiec 2025", "Nieznane".
         * For unknown dates, it returns a very large timestamp to place them at the end.
         * For month ranges, it takes the first month.
         * @param {string} dateStr The date string to parse.
         * @returns {Date} A Date object representing the date.
         */
        function parseDate(dateStr) {
            // Check for unknown date, return a very old date to put it at the end
            if (dateStr.includes("Nieznane")) {
                return new Date(0); // A very early timestamp
            }

            // Remove "ok." prefix if present
            dateStr = dateStr.replace("ok. ", "");

            // Handle date with day, month, and year (e.g., "1 Lipiec 2024")
            let parts = dateStr.split(" ");
            if (parts.length >= 3) {
                let day = parseInt(parts[0]);
                let month = monthMap[parts[1]];
                let year = parseInt(parts[2]);
                if (!isNaN(day) && month !== undefined && !isNaN(year)) {
                    return new Date(year, month, day);
                }
            }

            // Handle date with just month and year (e.g., "Kwiecień 2023")
            if (parts.length >= 2) {
                let month = monthMap[parts[0]];
                let year = parseInt(parts[1]);
                if (month !== undefined && !isNaN(year)) {
                    return new Date(year, month, 1);
                }
            }

            // Handle date with month range (e.g., "Maj/Czerwiec 2025")
            let monthRangeParts = dateStr.split("/");
            if (monthRangeParts.length >= 2) {
                let firstMonth = monthMap[monthRangeParts[0]];
                let year = parseInt(monthRangeParts[1].split(" ")[1]);
                if (firstMonth !== undefined && !isNaN(year)) {
                    return new Date(year, firstMonth, 1);
                }
            }
            
            // If all parsing fails, return a very early date
            console.error("Failed to parse date string:", dateStr);
            return new Date(0);
        }

        /**
         * Renders the chicken cards into the DOM.
         * @param {Array<Object>} chickens The array of chicken objects to render.
         */
        function renderChickens(chickens) {
            const container = document.getElementById('chicken-list');
            container.innerHTML = ''; // Clear existing content

            chickens.forEach(chicken => {
                const card = document.createElement('div');
                card.className = "chicken-card bg-gray-50 rounded-lg p-4 shadow-sm transition-transform transform hover:scale-105";
                
                card.innerHTML = `
                    <div class="image-wrapper">
                        <img src="${chicken.image}" alt="${chicken.name}" onclick="openModal(this)">
                    </div>
                    <h3 class="text-2xl font-semibold text-gray-900">${chicken.name}</h3>
                    <p class="text-gray-600 mt-1">
                        <span class="font-bold">Gatunek:</span> ${chicken.species}
                    </p>
                    <p class="text-gray-600">
                        <span class="font-bold">Data urodzenia:</span> ${chicken.dob}
                    </p>
                    <p class="text-gray-600">
                        <span class="font-bold">Nr. obrączki:</span> ${chicken.ringNumber}
                    </p>
                `;
                container.appendChild(card);
            });
        }

        // Sortowanie i renderowanie kart po załadowaniu DOM
        window.addEventListener('DOMContentLoaded', (event) => {
            // Dodajemy pole `isRooster` i `parsedDob` do każdego obiektu, aby ułatwić sortowanie
            const sortedChickens = allChickens.map(chicken => {
                return {
                    ...chicken,
                    isRooster: chicken.name.toLowerCase().includes('kogut'),
                    parsedDob: parseDate(chicken.dob)
                };
            });

            // Główne sortowanie
            sortedChickens.sort((a, b) => {
                // Koguty zawsze na początku
                if (a.isRooster && !b.isRooster) {
                    return -1;
                }
                if (!a.isRooster && b.isRooster) {
                    return 1;
                }

                // Sortuj od najmłodszych do najstarszych (data malejąco)
                return b.parsedDob.getTime() - a.parsedDob.getTime();
            });

            // Renderuj posortowane karty
            renderChickens(sortedChickens);
        });
    </script>
</body>
</html>

